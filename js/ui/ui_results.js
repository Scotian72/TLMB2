window.TallyLax=window.TallyLax||{};(function(TL){function row(g){var id=g.id||('g_'+Math.random().toString(36).slice(2));return'<tr data-action="openGame" data-param="'+id+'"><td class="mono">Day '+(g.day||'?')+'</td><td>'+g.awayOrg+' @ '+g.homeOrg+'</td><td>'+g.division+g.teamLevel+'</td><td class="mono">'+g.result.home+'-'+g.result.away+'</td></tr>'}TL.UIResults={show:function(){var root=document.getElementById('root');var html='<div class="panel"><h3>Results Browser</h3><table class="grid"><thead><tr><th>Day</th><th>Matchup</th><th>Lvl</th><th>Score</th></tr></thead><tbody id="resultsBody"></tbody></table></div>';root.insertAdjacentHTML('beforeend',html);var body=document.getElementById('resultsBody');body.innerHTML=(TL.GameState.gameLog||[]).slice(-80).reverse().map(row).join('')||'<tr><td colspan="4" class="muted">No games yet.</td></tr>'},openBox:function(g){var root=document.body;function side(s){var b=g.boxscore[s],logo='img/logos/'+(s==='home'?g.homeOrg:g.awayOrg)+'.png';var rows=b.players.slice(0,10).map(function(p){return'<tr><td>'+(p.name||p.pid)+'</td><td class="mono">'+(p.G||0)+'</td><td class="mono">'+(p.A||0)+'</td><td class="mono">'+(p.S||0)+'</td><td class="mono">'+(p.GB||0)+'</td><td class="mono">'+(p.CTO||0)+'</td></tr>'}).join('');return'<div class="card"><div class="flex"><img src="'+logo+'" style="width:28px;height:28px;border-radius:6px"/><strong>'+(s==='home'?g.homeOrg:g.awayOrg)+'</strong><span class="muted">'+g.division+g.teamLevel+'</span></div><div class="muted">SA '+b.SA+' • GA '+b.GA+' • SV% '+(b.svpct*100).toFixed(1)+' • QS '+b.QS+' • RBS '+b.RBS+'</div><table class="table"><thead><tr><th>Player</th><th>G</th><th>A</th><th>S</th><th>GB</th><th>CTO</th></tr></thead><tbody>'+rows+'</tbody></table></div>'}var html='<div class="modal" id="boxModal"><div class="sheet"><h3>'+g.awayOrg+' @ '+g.homeOrg+' — Final '+g.result.home+'-'+g.result.away+'</h3><div class="flex">'+side('away')+side('home')+'</div><div class="flex" style="margin-top:8px"><button class="btn" data-action="closeBox">Close</button></div></div></div>';root.insertAdjacentHTML('beforeend',html)}};document.addEventListener('click',function(e){var el=e.target.closest('[data-action]');if(!el)return;var a=el.getAttribute('data-action'),p=el.getAttribute('data-param');if(a==='openGame'){var g=(TallyLax.GameState.gameLog||[]).find(function(x){return x.id===p});if(g)TallyLax.UIResults.openBox(g)}else if(a==='closeBox'){var m=document.getElementById('boxModal');if(m)m.remove()}})})(window.TallyLax);