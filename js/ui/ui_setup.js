window.TallyLax=window.TallyLax||{};(function(TL){TL.UISetup={ensure:function(){if(TL.GameState&&TL.GameState.setupDone)return;this.open()},open:function(){var t=TL.TeamList||[];var cards=t.map(function(x){var l='img/logos/'+x.org+'.png';var sw='<div class="swatch" style="background:linear-gradient(90deg,'+(x.colors[0]||'#7aa2ff')+','+(x.colors[1]||'#e9ecff')+')"></div>';return'<div class="card team" data-action="pickOrg" data-param="'+x.org+'">'+sw+'<div class="flex"><img src="'+l+'" style="width:28px;height:28px;border-radius:6px;object-fit:cover"/><div><div><strong>'+x.org+'</strong></div><div class="muted">Founded '+(1980+Math.floor(Math.random()*40))+'</div></div></div></div>'}).join('');var html='<div class="modal" id="setupModal"><div class="sheet"><h2>Welcome to TallyLax</h2><p>Choose your club and create your profile.</p><h3>Choose Organization</h3><div class="grid-cards">'+cards+'</div><div id="setupStep2" class="hidden"><h3>President Details</h3><label>Name</label><input id="presName" class="input" placeholder="Your name"/><label>Season Length</label><select id="seasonLen" class="input"><option value="32">32 GP</option><option value="40" selected>40 GP</option><option value="48">48 GP</option></select><div class="flex" style="margin-top:8px"><button class="btn" data-action="finishSetup">Start Season</button></div></div><div class="flex" style="margin-top:8px"><a class="link" data-action="closeSetup">Skip (defaults)</a></div></div></div>';document.body.insertAdjacentHTML('beforeend',html)}};document.addEventListener('click',function(e){var el=e.target.closest('[data-action]');if(!el)return;var a=el.getAttribute('data-action'),p=el.getAttribute('data-param');if(a==='pickOrg'){TL.GameState.user=TL.GameState.user||{};TL.GameState.user.org=p;document.body.setAttribute('data-team',(p||'').toLowerCase());document.querySelector('#setupStep2').classList.remove('hidden')}else if(a==='finishSetup'){var nm=(document.getElementById('presName')||{}).value||'President';var gp=parseInt((document.getElementById('seasonLen')||{}).value||'40',10);TL.GameState.user.president=nm;TL.GameState.config=TL.GameState.config||{};TL.GameState.config.targetGP=gp;TL.GameState.setupDone=true;var m=document.getElementById('setupModal');if(m)m.remove();TL.SeasonManager.startNewSeason('USER');TL.UIDashboard.show()}else if(a==='closeSetup'){TL.GameState.setupDone=true;var m=document.getElementById('setupModal');if(m)m.remove();TL.SeasonManager.startNewSeason('SKIP');TL.UIDashboard.show()}})})(window.TallyLax);